# webgl-parallel_shader_compile

A simple WebGL application, to test the performance and behaviour of [KHR_parallel_shader_compile](https://developer.mozilla.org/en-US/docs/Web/API/KHR_parallel_shader_compile) across platforms and browsers.

# Live Example

https://htmlpreview.github.io/?https://github.com/mvaligursky/webgl-parallel_shader_compile/blob/main/index.html

The program creates a WebGL 2 instance, and renders a simple spinning triangle, which allows us to see the rendering being blocked.

On top of the web page, there are buttons to compile 10 or 50 instances of a shader. A large shader generated by [PlayCanvas Engine](https://github.com/playcanvas/engine), which implements PBR and a clustered lighting is used. There is a random number added in the source code of the fragment shader to avoid possibility of some caching behind the scenes.

### Overall implementation:
1. generates fragment and vertex shader source code for all shaders
2. trigger compile step on all vertex and fragment shaders
3. create programs, linking vertex and fragment shades, and trigger link step on all programs
4. inside requestAnimationFrame which executes each frame, for each frame which has not been processed yet
- test COMPLETION_STATUS_KHR using the extension. This is non blocking, and returns true if the shader is done linking.
- if shader is done linking, get its LINK_STATUS - this is blocking if the shader has not been done linking yet.

### Expectation:
- on platforms that implement the mentioned extension, the triangle rotates smootly with no blocking.

### Test Results:



# References
[1] - Basic WebGl spinning triangle application is based on https://www.tutorialspoint.com/webgl/webgl_rotation.htm
